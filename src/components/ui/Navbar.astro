---
import { Image } from 'astro:assets'
import {profile} from '../../settings'
import SocialIcons from './SocialIcons.astro'
import ProfilePictures from '@/assets/profile_pictures.jpg'
import { getCollection } from 'astro:content'
import { template } from '@/settings'

const isBlogPopulated = await getCollection('blog').then(collection => collection.length > 0)

const {fullName, title} = profile
---
<aside
	class='px-4 pt-4 h-screen w-[20rem] bg-base-200 text-base-content flex flex-col'
>
	<div class='flex flex-col my-8 justify-between h-full'>
		<div>
			<div class='mx-4 mt-8'>
				<ul class='space-y-4 menu grow shrink menu-md overflow-y-auto'>
					<li>
						<a href={`/candd/`} class='text-lg'>Home</a>
					</li>
					<li>
						<a href={`/candd/people`} class='text-lg'>People</a>
					</li>
					<li>
						<a href={`/candd/projects`} class='text-lg'>Projects</a>
					</li>
					<li class="menu-dropdown">
  <details>
    <summary>
      <a href={`/candd/papers`} class='text-lg'>Papers</a>
    </summary>
    <ul class="ml-4">
      <li><a href={`/candd/papers#economic-decision-making`} class="text-base">Economic Decision Making with Limited Attention</a></li>
      <li><a href={`/candd/papers#bounded-rationality`} class="text-base">Bounded Rationality in Macroeconomics</a></li>
      <li><a href={`/candd/papers#behavioral-economic-links`} class="text-base">Links Between Behavioral and Economic Phenomena</a></li>
      <li><a href={`/candd/papers#neuroeconomics`} class="text-base">Neuroeconomics</a></li>
      <li><a href={`/candd/papers#other`} class="text-base">Other</a></li>
    </ul>
  </details>
</li>
					<li>
						<a href={`/candd/links`} class='text-lg'>Links</a>
					</li>
				</ul>
			</div>
		</div>
	</div>
</aside>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    document.querySelectorAll('a[href^="/candd/papers#"]').forEach(function (link) {
      link.addEventListener('click', function (e) {
        const href = link.getAttribute('href');
        const anchor = href.split('#')[1];
        if (window.location.pathname.startsWith('/candd/papers')) {
          e.preventDefault();
          const el = document.getElementById(anchor);
          if (el) {
            el.scrollIntoView({ behavior: 'smooth' });
            history.replaceState(null, '', href);
            el.classList.add('highlight-section');
            setTimeout(() => {
              el.classList.remove('highlight-section');
            }, 1200);
          }
        } else {
          // Always navigate to the anchor, even from other pages
          window.location.href = href;
        }
      });
    });
  });

  // Highlight section after page load if anchor is present
  window.addEventListener('DOMContentLoaded', function () {
    const anchor = window.location.hash.replace('#', '');
    if (anchor) {
      const el = document.getElementById(anchor);
      if (el) {
        el.scrollIntoView({ behavior: 'smooth' });
        el.classList.add('highlight-section');
        setTimeout(() => {
          el.classList.remove('highlight-section');
        }, 1200);
      }
    }
  });
</script>
<style>
  .highlight-section {
    box-shadow: 0 0 0 4px #2563eb;
    transition: box-shadow 0.3s;
  }
</style>
